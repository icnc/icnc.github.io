<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>CnC: Marshalling pointer types (e.g. items which are pointers)</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />

<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">CnC
   
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#groups">Modules</a>  </div>
  <div class="headertitle">
<div class="title">Marshalling pointer types (e.g. items which are pointers)</div>  </div>
<div class="ingroups"><a class="el" href="group__serialization.html">Serialization</a></div></div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="groups"></a>
Modules</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__seralloc.html">Serialization of std::shared_ptr</a></td></tr>
</table>
<hr/><a name="details" id="details"></a><h2>Detailed Description</h2>
<p>A common optimization used by <a class="el" href="namespace_cn_c.html" title="CnC API.">CnC</a> programs targeting the shared-memory runtime is to store pointers to large objects inside of item collections instead of copies of the objects. This is done to minimize the overhead of copying into and out of the item collection. Programs written in this style can be sued with distCnC, but special care needs to be taken. <br/>
 Distributed <a class="el" href="namespace_cn_c.html" title="CnC API.">CnC</a> requires that data stored in item collections be serializable in order to communicate data between different processes. Consequently, the programmer must modify such pointer-using <a class="el" href="namespace_cn_c.html" title="CnC API.">CnC</a> programs in two ways in order to use the distributed-memory runtime. First, the programmer must provide a specialization of CnC::serialize for the pointer type pointing to T: </p>
<div class="fragment"><pre class="fragment">       <span class="keywordtype">void</span> CnC::serialize( <a class="code" href="class_cn_c_1_1serializer.html" title="Handles serilialization of data-objects.">CnC::serializer</a> &amp; ser, T *&amp; ptr ) {
           ser &amp; <a class="code" href="struct_cn_c_1_1chunk.html" title="Serialization of arrays with and without automatic memory handling.">CnC::chunk&lt; Your_class[, allocator] &gt;</a>( ptr, 1 );
       }
</pre></div><p> Please refer to <a class="el" href="struct_cn_c_1_1chunk.html" title="Serialization of arrays with and without automatic memory handling.">CnC::chunk</a> to learn about appropriate memory management. <br/>
 If the pointer represents a single object and not a C-style array, then the programmer may the use convenience macro: </p>
<div class="fragment"><pre class="fragment"> <a class="code" href="group__serialization.html#ga9c3d3b6b1b67f0e4479677b59452c3e5">CNC_POINTER_SERIALIZABLE</a>( T ); 
</pre></div><p> This macro implements the above method for the case when the pointer refers to only a single object (length == 1). Note that if T is a type that contains template parameters, the programmer should create a typedef of the specific type being serialized and use this type as the argument for the macro. <br/>
 Next, programmers must ensure that type T itself implements a default constructor and is serializable by itself. The latter as achieved as described above. It is the same method that programmers must provide if storing copies of objects instead of pointers to objects. <br/>
 Reading from and writing to item collections is not different in this style of writing <a class="el" href="namespace_cn_c.html" title="CnC API.">CnC</a> programs. However, there are a few things to note: <br/>
 When an object is communicated from one process to another, an item must be allocated on the receiving end. By default, <a class="el" href="struct_cn_c_1_1chunk.html" title="Serialization of arrays with and without automatic memory handling.">CnC::chunk</a> uses the default allocator for this and so requires the default constructor of T. After object creation, any fields are updated by the provided serialize methods. Thios default behavior simplifies the object allocation/deallocation: most of it is done automatically behind the scenes. The programmer should just pass an unitialized pointer to get(). The pointer will then point to the allocated object/array after the get completes. <br/>
 In advanced and potentially dangerous setups, the programmer might wish to store the object into memory that has been previously allocated. This can be done by an explicit copy and explicit object lifetime control. Please note that such a scenario can easily lead to uses of <a class="el" href="namespace_cn_c.html" title="CnC API.">CnC</a> which do not comply with <a class="el" href="namespace_cn_c.html" title="CnC API.">CnC</a>'s methodology, e.g. no side effects in steps and dynamic single assigments. </p>
</div><!-- contents -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Friends</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>



<hr class="footer"/><address class="footer"><small>
Generated on Fri Jun 6 2014 15:18:34 for CnC by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.7.6.1
</small></address>

</body>
</html>
